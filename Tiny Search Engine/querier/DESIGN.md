# CS50 TSE Indexer, Louis Weisdorf
## Design Spec

According to the Querier Requirements Spec, The TSE Querier is a standalone program that reads the index file produced by the TSE Indexer, and page files produced by the TSE Querier, and answers search queries submitted via stdin.

### User interface

The indexer's only interface with the user is on the command-line; it must always have two arguments.

```
querier pageDirectory indexFilename
```

For example, with crawldata and according indexer data from toscrape-1,

``` bash
$ querier .../../shared/tse/crawldata/toscrape-1 ../../shared/tse/indices/toscrape-1.ndx
```

### Inputs and outputs

**Input**: Upon prompting for a query, the querier reads input from stdin, which will then be processed to search for the entered strings.

**Output**: We print the search results of the querier to the stdout.

### Functional decomposition into modules

We anticipate the following modules or functions:

 1. *main*, which parses arguments and initializes other modules;
 2. *inputHandler*, which handles the input given from stdin and initializes other modules;
 3. *parseLine*, which parses the input into tokens;
 4. *queryHandler*, which processes the tokens, scoring search results;
 5. *disjunctionMerge*, which processes the merging of sets initiated in *queryHandler*;
 5. *conjunctionMerge*, which processes the intersection of sets initiated in *queryHandler*;
 6. *resultRanking*, which ranks the search results produced by the *queryHandler*;
 7. *queryOutput*, which prints the output of the search;

In addition, we anticipate various helper functions to supplement the functionality of these. 

And some helper modules that provide data structures:

 1. *index*, a module providing the data structure to represent the in-memory index, and functions to read and write index files;
 2. *pagedir*, a module providing functions to validate files in the pageDirectory;
 4. *word*, a module providing a function to validate and normalize a word.

### Pseudo code for logic/algorithmic flow

The querier will run as follows:

    parse the command line, validate parameters, initialize other modules
    prompt input from user via stdin, read, tokenize, and validate the input
    perform query operations (merging and intersecting counters) on the query
    ranking the resulting counter objects by sorting them from highest to lowest scores
    printing to stdout the ranked results, with information about score, docID, and webpage URL


### Major data structures

The key data structure is the *index*, mapping from *word* to *(docID, #occurrences)* pairs.
The *index* is a *hashtable* keyed by *word* and storing *counters* as items.
The *counters* is keyed by *docID* and stores a count of the number of occurrences of that word in the document with that ID. 
In addition, we create a new type *rankElement*, which stores a docID and score within the struct. This type is used for ranking the search results. 
We also create a new type *counterStruct*, which stores two counters. We use this type in the queryHandler, more specifically to intersect counters. 

### Testing plan

*Unit testing*.  There are no single modules in the *indexer* program that are specifically tested. Rather, the testing is done as integration testing for the entire program. 

*Integration testing*.  The *querier*, as a complete program, will be tested providing queries from the fuzzquery.c program, which generates search queries from an index file. With queries generated by fuzzquery for different index files, we run the *querier* on several indices. 